package nahi

import "bufio"

func GenerateAssemblyForDump(datawriter *bufio.Writer) {
	datawriter.WriteString("dump:\n")
	datawriter.WriteString("    mov     r9, -3689348814741910323\n")
	datawriter.WriteString("    sub     rsp, 40\n")
	datawriter.WriteString("    mov     BYTE [rsp+31], 10\n")
	datawriter.WriteString("    lea     rcx, [rsp+30]\n")
	datawriter.WriteString(".L2:\n")
	datawriter.WriteString("    mov     rax, rdi\n")
	datawriter.WriteString("    lea     r8, [rsp+32]\n")
	datawriter.WriteString("    mul     r9\n")
	datawriter.WriteString("    mov     rax, rdi\n")
	datawriter.WriteString("    sub     r8, rcx\n")
	datawriter.WriteString("    shr     rdx, 3\n")
	datawriter.WriteString("    lea     rsi, [rdx+rdx*4]\n")
	datawriter.WriteString("    add     rsi, rsi\n")
	datawriter.WriteString("    sub     rax, rsi\n")
	datawriter.WriteString("    add     eax, 48\n")
	datawriter.WriteString("    mov     BYTE [rcx], al\n")
	datawriter.WriteString("    mov     rax, rdi\n")
	datawriter.WriteString("    mov     rdi, rdx\n")
	datawriter.WriteString("    mov     rdx, rcx\n")
	datawriter.WriteString("    sub     rcx, 1\n")
	datawriter.WriteString("    cmp     rax, 9\n")
	datawriter.WriteString("    ja      .L2\n")
	datawriter.WriteString("    lea     rax, [rsp+32]\n")
	datawriter.WriteString("    mov     edi, 1\n")
	datawriter.WriteString("    sub     rdx, rax\n")
	datawriter.WriteString("    xor     eax, eax\n")
	datawriter.WriteString("    lea     rsi, [rsp+32+rdx]\n")
	datawriter.WriteString("    mov     rdx, r8\n")
	datawriter.WriteString("    mov     rax, 1\n")
	datawriter.WriteString("    syscall\n")
	datawriter.WriteString("    add     rsp, 40\n")
	datawriter.WriteString("    ret\n")
}
